const utilities = require("./utilities");
const maze = getInput();
const connectedNodes = {};
const connectedPortals = {};

for (let i = 0; i < maze.length; i++) {
  for (let j = 0; j < maze[0].length; j++) {
    if (maze[i][j] === ".") {
      setConnections(i, j);
    }
  }
}

const [start] = connectedPortals["AA"];
const [end] = connectedPortals["ZZ"];
[["AA"], ["ZZ"]].forEach(code => delete connectedPortals[code]);

Object.values(connectedPortals).forEach(([coor1, coor2]) => {
  connectedNodes[coor1].push(coor2);
  connectedNodes[coor2].push(coor1);
});
console.log(utilities.getMinimumSteps(pos => connectedNodes[pos], start, end));

function setConnections(i, j) {
  connectedNodes[`${i},${j}`] = [];
  [
    [1, 0],
    [-1, 0],
    [0, 1],
    [0, -1]
  ].forEach(([iShift, jShift]) => {
    if (maze[i + iShift] !== undefined) {
      const neighbour = maze[i + iShift][j + jShift];
      if (neighbour === ".") {
        connectedNodes[`${i},${j}`].push(`${i + iShift},${j + jShift}`);
      } else if (neighbour.match(/[A-Z]/)) {
        const portalCode = [
          maze[i + iShift][j + jShift],
          maze[i + 2 * iShift][j + 2 * jShift]
        ];
        if (iShift === -1 || jShift === -1) portalCode.reverse();
        const portal = portalCode.join("");
        if (connectedPortals[portal] === undefined) {
          connectedPortals[portal] = [`${i},${j}`];
        } else connectedPortals[portal].push(`${i},${j}`);
      }
    }
  });
}

function getInput() {
  return `                                         J           W         D   K     J       P   R   M                                             
                                         I           O         E   I     K       W   T   H                                             
  #######################################.###########.#########.###.#####.#######.###.###.###########################################  
  #...#.....#.....#.#.......#.......#.#.#.....#.........#.......#.#...#.........#...#...#...............#.....#.#...#.........#.#.#.#  
  ###.#.###.#####.#.#.###########.#.#.#.###.#####.###.#.#####.###.###.#########.###.#.#.#####.#.#####.#####.###.#.#######.#.###.#.#.#  
  #...#...#.......#.......#.......#.............#.#.#.#.#...#.....#.#.....#.......#...#.#...#.#.#...#.#...#...#.#...#...#.#.........#  
  ###.###.#.#.#.#####.#################.#.#######.#.#####.#.###.###.#.#.###.#######.###.#.#.###.#.#####.###.###.#.###.#####.#########  
  #.#...#.#.#.#.#.#.#.#.#...#.......#.#.#.....#.......#...#.....#...#.#.#...#...#...#...#.#.........#...#...#.#.....#.#...#...#...#.#  
  #.###.#######.#.#.#.#.###.#######.#.#.#####.###.###.###.#########.###.#.###.#.#####.###.#######.###.###.###.#.#####.#.###.###.###.#  
  #.....#...#.#.......#...#...#.#.....#.#...#...#...#...#.......#.#.....#.....#.#.......#.#.....#.........#.#.......#.#.#...........#  
  #####.#.###.#######.###.###.#.#####.###.#####.#.###.#######.###.###.###.#.###.#.#.#.###.###.#####.#.###.#.#.#######.#.#.###.#######  
  #...#...#...#.......#...............#.....#...#.#.....#.........#.....#.#.#.#.#.#.#.#...#.....#...#...#...................#.#.#...#  
  ###.#.#####.###.###.###.#.###.###.#.#.#.#.#.###.#.###.###.###.#.#####.#####.#.#.###.###.#.###.#####.#.#.#######.#######.###.#.#.###  
  #...#.#.#.......#.......#.#.....#.#...#.#.#...#.#.#...#.....#.#.#.#...#.....#.#...#.#...#.#...#.#.#.#.#.....#.#.....#.#.#...#...#.#  
  #.###.#.#############.###.#.#.#.#######.#.#.#########.#.###.#####.#.###.###.#.#.#######.#.#.###.#.#####.###.#.#######.#######.###.#  
  #.....#...#.......#.....#.#.#.#.#...#...#.....#.......#.#.......#.....#...#...#...#...#.#.#...........#.#.#...........#...#.......#  
  #####.#.#####.#.###################.###.#############.#.#####.#######.###.#####.#####.#.#.###.###.#.#.###.###.###.#.#.###.#.#######  
  #.#.....#.#.#.#.....#.#...#...#...............#.....#.#.#...#.#.#.#.#.#.....#.....#.#.......#.#.#.#.#.....#.....#.#.#.#.......#.#.#  
  #.#####.#.#.###.###.#.###.#.#############.#.#.#.###.#.#.#.#####.#.#.#.###.#######.#.#.#.###.#.#.###.#####.###.#######.#####.###.#.#  
  #.#...#.....#.....#.#...........#.#.#.#.#.#.#.#.#.#.#.#.........#.......#.#.#.....#...#...#.#.#.#.#.....#.#.#.......#...#.#.#.....#  
  #.#.###.#######.#######.#.###.###.#.#.#.#.#######.#.#.#.###.#.#######.###.#.###.#######.#####.#.#.#########.#.#.#########.#.#####.#  
  #...#.......#.........#.#.#.....#.........#...#.#.....#.#...#...#.....#.......#.......#.#...#...........#.#.#.#.#.....#.#.#.......#  
  ###.###.###.#.###.#.#######.#####.#####.#####.#.###.#.#.#####.#######.###.#########.#.#####.#.#####.#####.#.#####.#####.#.#.#######  
  #...#...#.#.#...#.#.#...........#.#...............#.#.#.....#.#.#.....#...#...#.....#...#.......#.#.#.......#.....#.#.#...#.......#  
  ###.###.#.###.###.#########.###.###.#.#.#############.#.###.###.#####.#.###.###.#.#########.#.###.#########.#.#####.#.###.#.#######  
  #...#.#.#.#.....#.#.....#.....#.....#.#.#...#...#.....#.#.#...#.....#.#.......#.#.#...#.#...#.#...#.#.#.#.........#.#.#.#.....#...#  
  ###.#.#.#.#.###########.#########.#####.#.#####.#####.###.#.###.#.###.#.#.#######.#.#.#.###.#.#.###.#.#.###.#######.#.#.###.###.#.#  
  #.#.........#...#.........#.....#...#.#...#...#.....#.#.......#.#.#...#.#.....#.....#.....#.#.......#.....#...#.#.#.....#.......#.#  
  #.###.###.#####.#######.#####.#.#.###.#.#.#.#####.###.#.#########.#.#######.#########.#.#####.###.#.#.#.###.###.#.#.#######.#######  
  #.....#.#.#.....#.#...#.....#.#...#.....#.....#.#.#...#.....#.#.#.#.#.......#.......#.#...#...#.#.#.#.#...#...#...#.......#.......#  
  #.###.#.#####.###.#.#######.#########.###.#####.#.###.#.#.###.#.#.#.###.###.###.###.#.#######.#.#####.#####.###.###.###.###.#.#####  
  #.#.......#.#.....#...#.#...#.#.......#.......#...#...#.#.......#.#...#...#.#.#.#...#.#.................#.#.#.#.......#.#...#.#.#.#  
  #####.#####.#.#####.###.###.#.#######.#####.###.#.#.#######.#####.###.#.#.###.#.#.###.#.#.#####.###.#####.#.#.#.#########.#.###.#.#  
  #.........#.......#.#.#.........#.....#...#.#.#.#...#.....#...#.......#.#...#...#.....#.#.....#.#.#.#...#.#...#.........#.#.#.#.#.#  
  #.#.#.#####.#######.#.#.#####.#######.#.###.#.#.#######.#####.#.###.#.###.#####.###.#.#######.#.#.#####.#.#.###.#.#########.#.#.#.#  
  #.#.#...#...#...#.#...#.#.#.....#...#.#.......#.....#.........#...#.#.#.......#...#.#.....#...#.....#...........#...#...#...#.#...#  
  #####.#.#.#.#.###.#.#####.###.###.#####.#######.#######.#######.#############.#.#.#########.#####.#####.###.###########.#.#.#.#.###  
  #.....#.#.#.#.........#.#.....#...#    T       G       S       B             E Q S         R    #...#...#...#.....#...#.#.#.#.#...#  
  #####.#####.#######.###.###.###.###    J       M       G       O             V Z W         T    ###########.###.###.###.###.#.#.###  
  #...........#...........#...#.....#                                                             #...#...#.#.....#...#.....#.......#  
  ###.#######.#.#####.###.###.###.#.#                                                             #.#####.#.###.#####.###.#######.###  
SG..#.......#.......#...#.#.....#.#..RK                                                           #...#.#.....#.#.#.....#.......#.#.#  
  #.#######.###.#.#######.#.#.#.###.#                                                             #.###.###.###.#.#.#####.#######.#.#  
  #.......#.#...#.#...#...#.#.#...#.#                                                             #...#.#...#.#...........#...#......SW
  #.###.#.#.#######.###.#.#.#.#.#.#.#                                                             #.###.###.#.#.###.#.###.###.#####.#  
  #...#.#.......#.#...#.#...#.#.#...#                                                           RX....#...#.....#...#...#.....#...#.#  
  ###.###.#.#####.###.###########.###                                                             #.#####.#.#####.#######.###.###.#.#  
  #.#.#.#.#.#.#...#.........#.#.#.#.#                                                             #.#.#...#.#.#.#.#...#.#.#...#.....#  
  #.###.#####.#.#######.###.#.#.###.#                                                             #.#.#.#.#.#.#.#####.#.#####.#.###.#  
ZN........#.......#.#...#.#.#...#....MH                                                           #.....#.....#...#...#.#...#...#...#  
  #.#########.#.###.#.###.#.#.#.###.#                                                             #############.###.###.###.#########  
  #...#...#.#.#...#...#.#...#.#...#.#                                                           DE....#...#...#...#.................#  
  #.#####.#.###.#.#.#.#.#.###.###.#.#                                                             #.#.#.#.#.#.#.#.#.###.###.#####.#.#  
  #.............#...#...#.....#.....#                                                             #.#.#.#...#.#.#...#...#.....#...#.#  
  ###################################                                                             ###.#.#####.#.###.#########.#####.#  
  #.......#.................#.......#                                                             #...#.#.....#.#.#...#.....#.#.#....ZZ
  #.#####.#.#####.#.#.###.###.###.#.#                                                             ###.#.#.#####.#.###.#.#######.#.###  
  #.#.........#...#.#.#.#...#.#...#.#                                                             #.....#.........#...#...#..........HL
  #.#######.#####.#####.###.#.#.#####                                                             ###.###.###############.#######.#.#  
  #.....#.#...#...#.........#.#.#....KI                                                           #...#...#...........#.#.......#.#.#  
  #.#.###.#.###.#######.#####.#.###.#                                                             #####.###.###.###.###.###.###.#####  
RX..#.#.#.#.#...#.#...........#.....#                                                             #.#.#.#.....#.#.....#.#...#.....#.#  
  ###.#.#.#######.#.#.#####.#.#.#.#.#                                                             #.#.#####.#########.#.###.#.#####.#  
  #.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#                                                           XK....#.......#.....#.#.....#.#......RK
  #.###.#.###.#.#.#####.#.###.#######                                                             ###.#.#.###.###.###.#.#.###.###.###  
BO....#.#.#.....#...#.......#.#.#...#                                                             #.....#.#.#...#.#.#...#...#.....#.#  
  #.#.#.#.###.###.###.#########.#.###                                                             #########.#####.#.#.###.###.#.#.#.#  
  #.#.#.#.#.#...#...#.....#.#...#....WO                                                         UJ......#.#.........#.#.#.#.#.#.#...#  
  ###.#.#.#.#.#.#.#.#.#.###.###.#.###                                                             #####.#.###.###.###.#.###.###.#####  
  #.....#.....#...#...#.............#                                                             #.....#.#.....#...#.#...#...#.#.#.#  
  #####.#####.###########.###.###.###                                                             ###.###.#####.#.#.###.#.#.#####.#.#  
  #...#.#...#.#...#.....#...#.#.....#                                                             #.#...#.....#.#.#...#.#.#.#.#......IT
  #.#.###.#.###.#.###.#.###.#######.#                                                             #.###.#.#.###.#.#######.#.#.#####.#  
  #.#...#.#.#...#.#.#.#.#.#.#.#...#.#                                                             #...#...#.....#...................#  
  #.#.#.#.#.#.###.#.#.#.#.#.#.#.#.###                                                             ###.###############################  
YD..#.#...#...#...#...#.#.#.#...#.#.#                                                             #.............................#...#  
  #.#####.#####.###.#.###.#####.###.#                                                             ###.###.#####.#.#.#####.#####.#.#.#  
  #.#.....#...#.....#................ZN                                                         YD..#...#...#...#.#...#.#.#...#.#.#..ST
  ###########.#####.#.#.#.###.#.#####                                                             #.#.###.###.#.#.###.#.###.#.#.#.###  
XK....#...#.......#.#.#.#.#.#.#.#...#                                                             #.#...#.#.#.#.#...#...#...#...#...#  
  #.#.#.#.#.###.#.###.###.#.#######.#                                                             #.#.#.###.###########.###.#####.###  
  #.#...#.....#.#.#.#.#.#.#...#.....#                                                             #...#...#...#...#.#.#...#.........#  
  #.###########.###.#.#.###.#.###.#.#                                                             #########.#####.#.#.#########.#.###  
  #.#...........#.#.#.#.....#...#.#.#                                                           HL..#...#.......#.....#.......#.#.#..GM
  #.#.###.#######.#.###.#######.#.#.#                                                             #.#.#.###.###.#.###.#.#####.#####.#  
  #.#.#...................#.#.....#..JK                                                           #...#.#.#...#.#...#.....#.#.#.#.#.#  
  #.#####.#############.###.#########                                                             ###.###.###.#.#.###.#####.#.#.#.#.#  
  #.#...#.#.#.#.......#.#.#...#.....#                                                             #...#.....#.#.....#...#.....#.....#  
  #####.###.#.#.#.#.#.###.#.#.###.###                                                             #.###.#.###.###.###.#.###.###.###.#  
  #.#.#.........#.#.#...#...#.......#                                                             #.....#.......#.#...#.#.......#...#  
  #.#.#.#####.#.###.###.#.#######.#.#                                                             #.#######.###.#####.###.#####.#####  
JO........#...#...#.#...#.....#...#.#                                                             #...#.......#...#...#...#.....#...#  
  #####.###.#######.###.###.###.#.#.#                                                             #.#.#######.#.#.#######.###.#.#.#.#  
  #.......#...#.......#.....#.#.#.#..ST                                                           #.#.....#...#.#.#.........#.#...#.#  
  ###.#########.#.#.###.#.###.#####.#                                                             ###.#.###.#.#######.#######.#######  
  #...........#.#.#...#.#...#...#.#.#                                                             #...#.#...#...#.#...#.#.......#...#  
  #######.#######.#.#####.#####.#.#.#            P       Z         J       I   J           A      #.#.#####.###.#.#.###.###.###.#.###  
  #.........#...#.#.#.......#.#.....#            W       A         I       T   O           E      #.#...#...#.....#.#.......#.......#  
  #.###.###.#.#.#######.#.###.#.###.#############.#######.#########.#######.###.###########.#############.#######.#######.#.#.###.#.#  
  #.#...#...#.#...#.....#.....#.#.........#.......#.#.....#.#.#.#...#.#.......#.....#.#.#.#...#...#...#.....#...#.....#...#.#...#.#.#  
  #.#.#####.#####.#####.###.#######.#######.###.###.#.#####.#.#.###.#.#.###########.#.#.#.#.###.###.#########.###.#.###.###.###.#.###  
  #.#...#.....#.#.#.#.#...#.#.#.........#...#.....#.........#.#...#.#...#...#.....#...#.#.#.........#.#.........#.#...#.#.....#.#...#  
  #.#####.#####.#.#.#.#.###.#.#.###.#####.#.#####.###.#.###.#.#.#.#.#.#.#.#.#.###.#.###.#.#.###.#.###.#.###########.#####.#.#####.#.#  
  #.#.#.....#.............#.#...#.#.....#.#.#...#.#.#.#...#.#...#...#.#.#.#.#.#.#.#...#.......#.#...#.........#.#.#...#...#.....#.#.#  
  ###.#.#.###.#.###.#.###.#.#.###.#.###.#.#.#.###.#.###.#.#.#.#######.###.#.#.#.#.#.###.###.#.#######.###.#####.#.#.#######.#####.###  
  #.....#.#...#.#...#.#.#.#.#.#.....#...#.#.#.........#.#.#.#.#.#.........#.#.#.......#.#.#.#...#...#.#.#.#.#.........#.#.......#.#.#  
  #.###.#######.#.#.###.#.#####.#.#.#######.#.#.#.#.#######.#.#.#.#.#######.#.#########.#.#########.#.#.###.###.#.#.#.#.###.#.###.#.#  
  #.#...#.....#.#.#.#.........#.#.#.....#...#.#.#.#.#...#...#.#.#.#.#.......#.....#.....#...#...#...........#...#.#.#.....#.#...#...#  
  #####.###.#.#####.#.#.###.###.#.#.#.#############.###.###.#.#.#.###.#.#########.###.#.#.#.###.#.#######.###.#####.###.###.#######.#  
  #.....#.#.#.......#.#.#.#...#.#.#.#.....#.....#.......#.#.#...#.#...#.#...#.......#.#...#...........#.#.#.....#.....#.#...#...#.#.#  
  ###.#.#.#.###.###.#####.#####.#####.#######.#####.#####.#.#.#####.#.###.#.###.###########.###.#####.#.#######.###.#####.#.###.#.#.#  
  #...#...#...#.#...#.......#.#.#.#...#...............#.....#.#.#.#.#.....#.#.....#.........#.......#.......#...#.......#.#.......#.#  
  #.#####.#.###.#.#.###.#.#.#.#.#.###############.#.#######.#.#.#.#.#######.###.#.#####.#######.#.#.#.#.#.#####.#.#.###.###.#.#####.#  
  #.#.....#.#...#.#.#.#.#.#.......#.#...#.....#...#.#.#.....#.....#.#.......#...#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#...#.#  
  #.#####.#####.#####.###.#########.###.###.#######.#.#.###.#.###########.#####.#.###.#.#.#.#.#######.#####.#.#####.#.#.###.###.#####  
  #.....#.#.......#.......#.....#.......#...#...#...#.#.#...#.....#.#.......#.#.#...#.#.........#.#.#...#.#.......#.#.#.#.......#...#  
  #####.#######.#######.#######.#######.###.#.#####.#.#####.#.#.###.#######.#.###.###.###.###.###.#.#####.#.#.#####.#.#.#.#.#.#.###.#  
  #.....#.............#.#.#.#...#...#.....#...#.......#.....#.#...#.#.....#...#.#...#.#...#.................#.#.#.#.#.#.#.#.#.#.....#  
  #.###.#####.#.###.#####.#.###.#.#######.###.###.#.#######.#.#####.#.#.###.###.#.###.#######.#.#.#.#####.#####.#.#####.#####.#####.#  
  #.#...#.....#.#.#.#...#...#.....#.#...#.#.#...#.#.......#.#...#.#.#.#.#.#.#.#.....#...#.#.#.#.#.#.....#.#.#.....#.#...#.#.......#.#  
  #.#.#.#####.###.#####.###.###.#.#.#.###.#.#.#.#.#########.###.#.#.###.#.#.#.###.#.#.###.#.#.#.#.#.#.#.#.#.###.###.#####.###.###.#.#  
  #.#.#.#.#.#.#...#.#.........#.#.............#...#.......#.#...#.#.....#.....#...#.#.......#.#.#.#.#.#.#.........#...#...#.#...#.#.#  
  #####.#.#.#####.#.#######.#.###.###.#.#####.#######.#####.#.###.###.#.#.#######.#.#.###.###.#.###.#######.#.###.#.#####.#.#.#.#####  
  #.....#...#...#.#.#.#.....#.......#.#.#.............#.....#...#...#.#.....#.....#.#.#.#...#.#.#.......#...#.#.....#.........#.....#  
  ###.###.###.#.#.#.#.#.#.#.#.###.###.#.###.#######.#######.###.#.#.#.#############.#.#.###########.###.#.#.#######.#.###.###.#######  
  #.#.#.#.#.#.#.#.......#.#.#.#.....#.#.#.#.#.........#.....#...#.#.#.........#.#...#...#...#.#...#...#.#.#.......#.#.#...#.......#.#  
  #.###.#.#.###.###.###.#######.#.###.###.###.#############.#.###.#.#.#####.###.###.#.###.###.#.###.#######.#.#.###########.#.#.#.#.#  
  #.......#...#...#.#...#.#.#.#.#.#...#.#.............#.#...#.....#.#.#.#...#...#...#.....#.......#.#.....#.#.#.#...........#.#.#...#  
  #######.#.#####.#.#####.#.#.###.#####.#.#########.###.#.#########.###.#.#.#.#.###.###.###.#####.#.#.#.#.###########.#.###.###.#.###  
  #.....#.............#...#.........#.....#...#.....#.......#.#.........#.#.#.#.....#...#.#...#...#...#.#...........#.#.#...#.#.#...#  
  #.#.###.###.###.#######.#.#.#.#.###.#.#.###.#.###.#######.#.#.###.#######.###.#.###.###.#.#########.#######.#.###########.#.###.#.#  
  #.#.....#.....#.#.........#.#.#.#...#.#.#.......#.#.........#...#.#.......#...#...#.............#.........#.#.....#...........#.#.#  
  ###############################################.#####.#.#######.#######.#########.#####.###########################################  
                                                 A     U A       Q       T         E     Z                                             
                                                 E     J A       Z       J         V     A                                             `.split(
    "\n"
  );
}
