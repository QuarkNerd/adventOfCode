use std::collections::HashSet;
use std::collections::HashMap;

#[derive(Debug, Copy, Clone)]
enum ClockwiseTwist {
    Zero = 0,
    One = 1,
    Two = 2,
    Three = 3
}

impl ClockwiseTwist {
    fn rot(&self) -> ClockwiseTwist {
        match self {
            ClockwiseTwist::Zero => ClockwiseTwist::One,
            ClockwiseTwist::One => ClockwiseTwist::Two,
            ClockwiseTwist::Two => ClockwiseTwist::Three,
            ClockwiseTwist::Three => ClockwiseTwist::Zero,
        }
    }

    fn from(num: u8)  -> ClockwiseTwist {
        match num {
            0 => ClockwiseTwist::Zero,
            1 => ClockwiseTwist::One,
            2 => ClockwiseTwist::Two,
            3 => ClockwiseTwist::Three,
            nu => panic!("Invalid number to convert to twist: {}", nu)
        }
    }
}

// make this generic
// and add all functions
struct SideToTileHash {
    hash: HashMap<String, Vec<u64>>,
}

impl SideToTileHash {
    fn get_mut(&mut self, key: &String) -> Option<&mut Vec<u64>>{
        let first = self.hash.get(key);
        if first.is_some() {return self.hash.get_mut(key);};
        self.hash.get_mut(&reverse(&key))
    }

    fn get(&mut self, key: &String) -> Option<&Vec<u64>>{
        let first = self.hash.get(key);
        if first.is_some() {return self.hash.get(key);};
        self.hash.get(&reverse(&key))
    }

    fn insert(&mut self, key: String, value: Vec<u64>) -> Option<Vec<u64>> {
        self.hash.insert(key, value)
    }
}

struct Edges {
    flip_first: bool,
    rotation: ClockwiseTwist,
    sides: Vec<String>
}

impl Edges {
    fn new(sides: Vec<String>) -> Edges {
        Edges {
            flip_first: false,
            rotation: ClockwiseTwist::Zero,
            sides,
        }
    }

    fn algin_left<'a>(&mut self, edge: &'a str) {
        self.algin_edge(edge, 3);
    }

    fn algin_top<'a>(&mut self, edge: &'a str) {
        self.algin_edge(edge, 4);
    }

    fn algin_edge<'a>(&mut self, edge: &'a str, side_num: usize) {
        if let Some(index) = self.sides.iter().position(|r| r == edge) {
            let shift = side_num - index;
            self.rotation = ClockwiseTwist::from(((shift + self.rotation as usize)%4) as u8);
            self.sides.rotate_right(shift);
        } else {
            self.flip_first = !self.flip_first;
            self.sides = self.sides.iter().map(|x| reverse(x)).collect();
            self.sides.swap(1,3);
            if let Some(index) = self.sides.iter().position(|r| r == edge) {
                let shift = side_num - index;
                self.rotation = ClockwiseTwist::from(((shift + self.rotation as usize)%4) as u8);
                self.sides.rotate_right(shift);
            } else {
                panic!("There is no edge matching: {}", edge)
            }
        }
    }

    fn set_as_top_left<'a>(&mut self, unmatched_sides: (&'a str, &'a str)) {
        loop {
            if Edges::do_double_sides_match(unmatched_sides, (&self.sides[0], &self.sides[3])) {
                break;
            }

            self.rotation = self.rotation.rot();
            self.sides.rotate_right(1);
        }
    }

    fn do_double_sides_match<'a>(unmatched_sides: (&'a str, &'a str), sides: (&'a str, &'a str)) -> bool {
        if (unmatched_sides.0 == sides.0 && unmatched_sides.1 == sides.1) || 
           (unmatched_sides.1 == sides.0 && unmatched_sides.0 == sides.1) {
            return true;
        }

        let unmatched_sides = (&unmatched_sides.0.chars().rev().collect::<String>(), unmatched_sides.1.chars().rev().collect::<String>());
        if (unmatched_sides.0 == sides.0 && unmatched_sides.1 == sides.1) || 
           (unmatched_sides.1 == sides.0 && unmatched_sides.0 == sides.1) {
            return true;
        }

        false
    }
}

fn main() {
    
    let tiles = INP.split("\n\n");
    let mut side_to_tile_hash: SideToTileHash = SideToTileHash { hash: HashMap::new()};
    let mut tile_to_edges_hash: HashMap<u64, Edges> = HashMap::new();
    let mut tile_to_inner_image_hash: HashMap<u64, Vec<String>> = HashMap::new();
    for ti in tiles {
        let spl : Vec<_> = ti.split(":\n").collect();

        let tile_num = spl[0].split(' ').collect::<Vec<&str>>()[1].parse::<u64>().unwrap();
        let tile: Vec<_> = spl[1].split('\n').collect();

        let edges = get_edges(&tile);
        tile_to_edges_hash.insert(tile_num, Edges::new(edges.clone()));
        tile_to_inner_image_hash.insert(tile_num, strip_edges(&tile));

        println!("{:?}", strip_edges(&tile));

        for edge in edges {
            if let Some(tile_num_vec) = side_to_tile_hash.get_mut(&edge) {
                tile_num_vec.push(tile_num);
            } else {   
                let mut vec = Vec::new();
                vec.push(tile_num);
                side_to_tile_hash.insert(edge, vec);
            }
        };
    }

    let mut tiles_with_unmatched_sides = HashSet::new(); 
    let mut corner_multi = 1;
    let mut first_corner_tile = 0;
    for (_, value) in &side_to_tile_hash.hash {
        if value.len() == 1 {
            if !tiles_with_unmatched_sides.insert(value[0]) {
                corner_multi *= value[0];
                first_corner_tile = value[0];
            }
        }
    }

    println!("Part One: {}", corner_multi);

    let mut unmatched_sides = Vec::new();

    for edge in &(tile_to_edges_hash.get(&first_corner_tile).unwrap().sides) {
        if let Some(tile_num_vec) = side_to_tile_hash.get_mut(edge) {
            if tile_num_vec.len() == 1 {
                unmatched_sides.push(edge.clone())
            }
        }
    }
    
    tile_to_edges_hash.get_mut(&first_corner_tile).unwrap().set_as_top_left((&unmatched_sides[0], &unmatched_sides[1]));
    
    
    let mut aligning_edge: String;
    let mut current_tile = first_corner_tile;

    let mut image: Vec<Vec<u64>> = Vec::new();
    let mut row: Vec<u64> = Vec::new();
    row.push(current_tile);
    
    loop {
        loop {
            aligning_edge = tile_to_edges_hash.get(&current_tile).unwrap().sides[1].clone();
            match get_other_item(side_to_tile_hash.get(&aligning_edge).unwrap(), current_tile) {
                Some(tile) => {
                    current_tile = tile;
                    row.push(current_tile);

                    tile_to_edges_hash.get_mut(&current_tile).unwrap().algin_left(&reverse(&aligning_edge));
                },
                None => break,
            }
        }
        
        let initial_tile_of_last_row = row[0];
        image.push(row);
        let lower_edge_to_match = tile_to_edges_hash.get(&initial_tile_of_last_row).unwrap().sides[2].clone();


        match get_other_item(side_to_tile_hash.get(&lower_edge_to_match).unwrap(), initial_tile_of_last_row) {
                Some(tile) => {
                    row = Vec::new();
                    current_tile = tile;
                    row.push(current_tile);

                    tile_to_edges_hash.get_mut(&current_tile).unwrap().algin_top(&reverse(&lower_edge_to_match));
                },
                None => break,
            }
        
    }

    println!("{:?}", image);   
}
//: impl Iterator<Item = String>

fn apply_transformation<'a>(tile: &Vec<&'a str>, rot: ClockwiseTwist, flip_first: bool) -> Vec<String> {
    let mut tile = tile.iter().map(|x| x.to_string());
    match rot {
        ClockwiseTwist::Zero => {
            if flip_first {
                tile = tile.map(|x| reverse(&x)); // ask why this fails
            };
        },
        ClockwiseTwist::Two => {
            if !flip_first {
                tile = tile.map(|x| reverse(&x));
            };
            tile.rev();
        }
    };

    tile.collect()
}

fn get_edges<'a>(tile: &Vec<&'a str>) -> Vec<String> {
    let mut vec = Vec::new();
    vec.push(tile[0].to_string());
    vec.push(get_column(tile,tile.len()-1));
    vec.push(tile[tile.len()-1].chars().rev().collect::<String>());
    vec.push(get_column(tile,0).chars().rev().collect::<String>());

    vec
}

fn strip_edges<'a>(tile: &Vec<&'a str>) -> Vec<String> {
    tile[1..tile.len()-1].iter().map(|x| {
        x[1..x.len()-1].to_string()
    }).collect()
}

fn get_column<'a>(tile: &Vec<&'a str>, col: usize) -> String {
    let mut edge = "".to_string();
    for row in tile {
        edge.push_str(&row[col..col+1]);
    }
    edge
}

fn get_other_item<T: Clone+ Eq>(list: &Vec<T>, item:T) -> Option<T> {
    if list.len() > 2 {
        panic!("Called with too long a list");
    };

    if list.len() == 1 {
        return None;
    };

    if list[0] == item {
        return Some(list[1].clone());
    };

    Some(list[0].clone())
}

fn reverse(str: &String) -> String {
    str.chars().rev().collect::<String>()
}

static INP: &str =
"Tile 2311:
..##.#..#.
##..#.....
#...##..#.
####.#...#
##.##.###.
##...#.###
.#.#.#..##
..#....#..
###...#.#.
..###..###

Tile 1951:
#.##...##.
#.####...#
.....#..##
#...######
.##.#....#
.###.#####
###.##.##.
.###....#.
..#.#..#.#
#...##.#..

Tile 1171:
####...##.
#..##.#..#
##.#..#.#.
.###.####.
..###.####
.##....##.
.#...####.
#.##.####.
####..#...
.....##...

Tile 1427:
###.##.#..
.#..#.##..
.#.##.#..#
#.#.#.##.#
....#...##
...##..##.
...#.#####
.#.####.#.
..#..###.#
..##.#..#.

Tile 1489:
##.#.#....
..##...#..
.##..##...
..#...#...
#####...#.
#..#.#.#.#
...#.#.#..
##.#...##.
..##.##.##
###.##.#..

Tile 2473:
#....####.
#..#.##...
#.##..#...
######.#.#
.#...#.#.#
.#########
.###.#..#.
########.#
##...##.#.
..###.#.#.

Tile 2971:
..#.#....#
#...###...
#.#.###...
##.##..#..
.#####..##
.#..####.#
#..#.#..#.
..####.###
..#.#.###.
...#.#.#.#

Tile 2729:
...#.#.#.#
####.#....
..#.#.....
....#..#.#
.##..##.#.
.#.####...
####.#.#..
##.####...
##..#.##..
#.##...##.

Tile 3079:
#.#.#####.
.#..######
..#.......
######....
####.#..#.
.#...#.##.
#.#####.##
..#.###...
..#.......
..#.###...";

static INPUT: &str =
"Tile 3557:
.#...##.#.
#.#..#...#
##....#..#
.#...##..#
..###....#
..##..#...
#.#...##.#
..##..##..
.#.....##.
#.###.....

Tile 2203:
....#.#..#
##........
#.#...#...
#.#.##.###
.#....#..#
..#.#....#
#.....#...
#.#.#.....
.#...##.#.
##....##.#

Tile 3251:
...#.#.###
##.#...#.#
.#..##...#
....##...#
.#.......#
..#......#
#..#......
##.#.#.#..
#......#..
##.##.#...

Tile 3917:
.#.#...#.#
..........
#.#.#.####
#...#...#.
..#.##..#.
#.#.#.####
..#....#..
###.#....#
...##..#..
##.#####.#

Tile 2663:
.####.###.
....##..#.
......#..#
...#......
#.#.#..#.#
##.##.....
###.###...
..#..#....
##..##....
.#..##.#..

Tile 1093:
###.##...#
#....#....
#...#..#..
..##.#####
#.....##..
#....#.#..
#..#..#.##
#.#......#
...#.....#
#.##..###.

Tile 1279:
..###.##..
#.....#...
##..#....#
#...####.#
....###..#
#....#..##
..##...###
.##.#.....
##......#.
...##.#..#

Tile 3881:
##...#....
#..##.#..#
...###...#
....#...#.
###..#.###
..#...#..#
......#...
..#..#.#..
...##.##.#
#.#.#...#.

Tile 3793:
##...#.##.
...#..#..#
..#...##..
..###..#..
##......##
##......##
#..###.#.#
#.....#..#
.#.#..#..#
.#.##.###.

Tile 3919:
#####..###
##....###.
.####.#.##
#..#......
..#.#...##
.##..#...#
.....#...#
..#.....#.
...#......
.##.##.#.#

Tile 3769:
.#.####..#
......#..#
#......#.#
.#....#..#
.........#
..........
#.......#.
.#.....#..
#...#....#
####.#.#.#

Tile 1747:
...#...#.#
..#..#.#.#
.....#...#
#.##......
#.......##
.#........
#####.....
#.#..#....
..#.......
...#....##

Tile 2711:
.##..#.#.#
#.##......
......##..
.###...#..
.#......#.
#.#....#..
......#.#.
#....#.#..
#...#.#..#
#......##.

Tile 2801:
###....##.
#..#...#.#
....##.#.#
..........
..........
........#.
#....#....
#........#
....#..#..
##.#.#.###

Tile 2287:
####.#..#.
#..#..#...
....###..#
..#.......
#....#...#
......#...
##.....#..
.#......#.
#...##....
.#.####...

Tile 1607:
##.#.#.#.#
....#....#
......##.#
........##
#..#....##
#........#
#.#..#....
...#..#...
#....#.##.
.#...##.#.

Tile 1069:
####...###
#..##..#..
.........#
#.###.....
.#.##.#..#
#.#..#....
#.##..#..#
#...#...#.
.....#....
..#..#.#.#

Tile 1721:
####..#.#.
#.......##
.#.##.....
..........
..#..#...#
##..#..#.#
.....##..#
.#..#..#.#
##.#..#...
.#.##.#...

Tile 3049:
...#.####.
##.##..##.
.#........
.#.....#.#
.##.......
#..#.#...#
.#....#..#
###....#..
##..#..#.#
..###.#..#

Tile 1871:
####.#.##.
.....##...
####...##.
.........#
###.....#.
#.#......#
#..#...#..
#........#
#.##...#..
#......###

Tile 1723:
.#..######
.###....##
.........#
.........#
.....#..#.
##.#....##
...#.#..#.
....#...##
...#..#..#
##..##...#

Tile 2237:
.#.##.#.##
.#.......#
#.......##
..#...#...
....#...#.
#...#..##.
...##.#...
#..#.#....
##...###.#
#.#....###

Tile 1549:
#..###.###
.#..##...#
....##.#.#
#..#.##.#.
......#..#
#.#..##...
#..#....#.
#.#......#
....###...
##....#..#

Tile 3119:
#.#...####
#....##..#
..#....##.
#..#....##
#..#...#..
#...#...#.
....#..#..
.##...#..#
..#.#...#.
##..#.#.##

Tile 2129:
##.#.....#
#....#....
#.........
..##..##.#
#.#####.##
##......#.
#....#...#
.......##.
....##....
#.....####

Tile 3499:
#.#.##..##
.....##..#
##...#.#.#
......##..
#....#....
##......##
..#.#.....
###.###.#.
#..#.##...
######.#..

Tile 1249:
.##.#...##
###..#...#
.......#.#
.#.#..#..#
#.#...#..#
#..#..#..#
.....#....
....#.#.#.
....#....#
....##.#.#

Tile 2789:
##.#....#.
#....#.##.
...#....#.
#........#
###.....##
#........#
##.....#.#
####..##.#
.###.#.###
##.###.###

Tile 1447:
##..#.##..
...#...###
......#..#
...#..#...
..#....##.
...#.#....
..........
#..##.#...
##...#..#.
##..#..##.

Tile 1031:
.##..###.#
...#.##.#.
#....#...#
.......###
#.#......#
#.....##..
#....##.##
#..#.....#
........#.
.#..##....

Tile 1949:
#....#....
.#.#......
.#..##....
...###.#.#
....#...#.
#..#.....#
.#....#..#
.#.......#
..#.......
##.#..####

Tile 3079:
.###.#.#.#
..........
##......#.
.......###
#......#.#
#..#......
.##.......
..#.......
...##.....
#..#..#.##

Tile 2803:
.##.....#.
.#.....###
#...#....#
..#..#....
.......#.#
#......#.#
.#.##.####
..##....#.
#.#.#..#..
####.....#

Tile 1481:
..###.##.#
.#.#.#...#
##........
..#......#
.###.#.###
...##....#
.##.#....#
###...##..
.#.#.....#
##.###.##.

Tile 2003:
.###...##.
..#...##..
..#......#
###.......
#.##...#..
#..####...
##...#..#.
.....#...#
#......#..
..###.#.##

Tile 3697:
#...#...##
##...#....
.#...##...
.........#
#.#.#.#.#.
#.#......#
#..#.#..#.
#...#.#...
#...#.....
#..#.#..#.

Tile 3727:
##.#######
.#...#...#
.#...##..#
..##.....#
#..#....##
.........#
##.#...#..
##.#.....#
..#.......
..####..##

Tile 2699:
#.#..#.##.
##..#..#.#
####...#..
.......#..
#.#.....##
.#.......#
.....#.#.#
#..#.#....
.....#..#.
.....#..##

Tile 2011:
##..#.##.#
...#....##
#........#
..#.#.#.#.
.....#...#
#......##.
#.##..##.#
..##...##.
#.#.....#.
.#...###..

Tile 2777:
...####..#
#.##....#.
..........
##...###..
#.##....#.
.#.#.....#
..#..#.#.#
##...#..##
#.....#..#
#....#..#.

Tile 1787:
#.##....#.
##...#.#.#
#......#..
......##..
#....##..#
.....#....
....##....
#.#..#.##.
##....#..#
#.#.###.#.

Tile 1783:
#.#...#.#.
#..#.#...#
#..##..###
#..#.##...
.#....#...
##..##...#
#..#.....#
#.......##
#.#.....##
##..#.#..#

Tile 1423:
#.###.#..#
..#..##...
####..#.#.
#..##..#.#
.........#
##....#.##
#.##..#...
.........#
...##....#
#..#.###..

Tile 2917:
###...####
#....##..#
......#.#.
....#.##.#
....#....#
#........#
.#.....#..
...#.##..#
#...#.#..#
##...#..#.

Tile 1531:
#..#..#.##
...##.##.#
.......#.#
......#..#
....#....#
.#........
....#..#.#
...#....##
.#.#.##...
..##...#.#

Tile 1867:
#.#.#####.
.##...#..#
..........
#.##..#..#
#.###..#.#
.......#..
...#.#.###
...##.##..
.......#..
.##..###.#

Tile 1901:
##....####
.....##..#
#.#...#.##
.#.#..##..
...#...#.#
#..#...#.#
...##.#..#
#........#
...###...#
#####..#.#

Tile 2879:
.####.#..#
#.#.#..#.#
.##...#..#
####.##..#
..##.##...
##.......#
..........
#.#..##.#.
.#.#...#.#
.#..#.#.##

Tile 1187:
.#####.###
##.......#
.#...##.#.
.#..#.#.#.
.#..#..#.#
##....#...
#..#......
.##....###
.#.#...#.#
.#......##

Tile 1657:
..##.#..##
.#...###.#
....#.#..#
...#..#..#
..#......#
..#...#..#
...#...#.#
#.....#.#.
#..##..###
###.#.#..#

Tile 3533:
#####..#..
..#.#.##.#
.#........
........#.
.#...#.#..
.#........
.##.......
#......#..
#......###
.###.#.#.#

Tile 3037:
.#...#..##
#.#....#..
.....##...
#....####.
#..###.##.
#.......##
#..#..#...
#....###.#
#.....##.#
..#.###.##

Tile 2729:
.#.##.....
##...#..##
.#..#...#.
.#...#..#.
#.#...#...
###.#.#..#
#.........
.##...#.#.
##.......#
###..#.##.

Tile 3823:
...#...###
#..##.##..
...#......
...#....#.
....#....#
...#......
....#...##
#........#
...#....#.
#..#.#.#..

Tile 2081:
#..##..#..
...#....##
..........
#..#.#...#
#.#....#.#
#..#..#.#.
#####.#..#
....###.##
...#.#...#
.##..#.#..

Tile 1759:
#.#.#..#..
#........#
##........
#.#......#
.......#..
.#.#....##
....#.....
#......#..
#..##.#..#
..###...##

Tile 3467:
.#.####..#
#....###.#
...#..#...
#....#....
....##..##
#.#.......
#....#...#
.##...#.##
...#..#..#
##....#..#

Tile 3041:
...###.#..
.##.####..
.#.##..##.
#...##....
###......#
#...#....#
#..#.#.###
##.##.#..#
##.#.#...#
#..###..#.

Tile 2473:
###..#.#.#
#.##.##.##
#..#..#..#
##.......#
.#..#..#..
..##......
#.#...#...
...#.....#
.#....##..
#..##.#.##

Tile 3191:
.....#..##
##..#....#
#........#
.......##.
..#.#...##
...#.....#
.........#
..#.#.#...
##.#....##
#.#..#####

Tile 2269:
##..#.###.
#..#.#...#
#.....#..#
.#........
#.##..##.#
.....##.##
.......#.#
.#.......#
##.#..#.#.
.#.#.##.#.

Tile 1847:
...#...#.#
##.......#
#.......##
##........
##.......#
#..#..#...
...#....##
#.#.##...#
#.###....#
..##.####.

Tile 2399:
###....#.#
....#....#
....##..##
####.#...#
#........#
.....#...#
#..##.####
.#..#.....
##...#.#..
#.......##

Tile 1051:
.#..#....#
.......#..
.#...####.
#..#..#.##
##.....#..
##.#.#.#..
.#........
#..##..#.#
#...#.#.#.
##.#....##

Tile 3709:
#.....###.
#..#.#....
##..#..#.#
.......#.#
.....#..#.
.#..##.#.#
.###.##..#
#.##.#..##
..#......#
......##.#

Tile 1019:
##...##...
....#.....
.....#..#.
..........
##........
.........#
..........
#.#..#..#.
##....###.
#.####.#.#

Tile 1163:
...##...##
..#......#
......##..
..##..#...
#...#....#
#...#.##.#
....##....
#........#
#.......#.
##..####.#

Tile 1061:
###.#..#.#
.##.......
#.##..#...
.#..##..##
#...#.....
#......#.#
#..#.#...#
...#.#####
#...##.#.#
####.#.#..

Tile 1811:
....#..##.
.##.#....#
#.#.#..#..
###.....##
#.#......#
#...#.....
#...#.###.
#...#.....
..##......
##.#.####.

Tile 1301:
##.##.#..#
#.##.##...
#...#..##.
...#...#..
.#.#......
....#....#
....#....#
...#.....#
#.#.#.###.
#..#..####

Tile 1933:
.##.#.##.#
#...#.....
#.....###.
..##....#.
###...#...
##..#....#
#.....#..#
#......###
#.....#.##
.##.###.#.

Tile 1889:
##.#.##...
....#.....
..........
..##.##...
....##...#
#.#.#....#
...##.#...
.##.....#.
....##...#
..########

Tile 2411:
#...#.#..#
......#..#
#...#..#..
..#.....#.
#.#..#...#
..#......#
#...#.#...
.......#..
..........
..##..#.##

Tile 1861:
.##...#.##
.....##...
#........#
..#..#....
##.....#.#
.#####...#
.#.##..#.#
##..#....#
#.......#.
##..#..#..

Tile 2671:
..#..#....
##..#....#
#.#.......
.#.#.....#
...#......
..#......#
##........
###.....##
##.##.#.#.
..#.##..#.

Tile 2347:
#.####....
#.....#...
#...#.####
.###..#..#
#.#.#.....
#.#.......
........#.
..##..#...
#..###....
#..#...#..

Tile 1913:
#..#.#..##
#.#.#.#.#.
....#.#.#.
#.....#..#
#.#.###...
#.#..#.#..
.#.....#..
.##...#..#
#.......##
..#.#.##..

Tile 2887:
#####..###
....##...#
#......#..
###.#.###.
#........#
....#.....
####..###.
....#....#
....#.#...
.###..####

Tile 3449:
..###.#...
##.#.##..#
...#......
#..#......
..#.#...#.
#...#...#.
#.......##
.........#
...#.#...#
#.##.##..#

Tile 3947:
.......###
.#.#.....#
#.#.#..##.
..#...#.#.
#..#...###
....#..###
......#...
#..##.###.
..#...#..#
..##.#.##.

Tile 1109:
#.##..#.##
.#.......#
#.....##.#
.........#
#.#..#...#
#...#....#
#.........
#.#......#
.....#.#.#
.#.#####.#

Tile 1153:
#.#.###..#
####....##
......#...
........##
........#.
##..#....#
....#.#..#
#.#....#..
.#.#....##
.#....#.##

Tile 3259:
.#.#...###
##....##..
#...####..
.#...#...#
..#.#.#..#
#....###..
...#.###..
.....#.##.
#...#..#.#
.###...#.#

Tile 3659:
##.#..#.#.
#.......##
#.....##.#
.#..#.....
#...##.#.#
#.##...#..
.##.#..#..
.##.#..#.#
#.##..#.#.
#..#######

Tile 3833:
##.##....#
.###.....#
##.......#
##.#.##..#
..##....#.
##.......#
#....#....
#.#......#
.###.#.#..
..#..#....

Tile 3529:
##..#####.
#..#....##
...#.....#
#..##....#
.#.#.###.#
#.##......
.#.#...#..
#...##..##
.......#.#
..#.#.##.#

Tile 2819:
#.#..###.#
.......#.#
#...#..##.
##.#.....#
.#..#.....
.#..#.####
#.......##
.#...#....
####.....#
##.....##.

Tile 1801:
#####..##.
####..###.
#.#..#..#.
..#......#
...#....#.
#.#......#
...#.##..#
#...#.....
##....##..
.#.#..###.

Tile 1307:
######.##.
..#......#
.......##.
#.#....#..
#.#.#..#..
.........#
....##.#..
..##..##..
#....#...#
#...##.#.#

Tile 2719:
..#######.
#......#..
###....##.
#.....#.##
#..#..#.#.
....#....#
......##..
##.#...#.#
#.....#.##
#..##.##..

Tile 1973:
####..##.#
......#...
##.....##.
#..#..#...
......#...
.......#..
....#.#..#
##.#..###.
#.##...#.#
##.###.#.#

Tile 1553:
#....#..##
...#......
#........#
#..#.....#
..#.......
#..#.#.#..
.......#..
.#.#...#..
##.#.....#
.###..#.#.

Tile 3271:
.#..#..#.#
#.#...#.##
#......#.#
###......#
#....#....
##.......#
#..#.##..#
#.......#.
...#.#....
.###.#####

Tile 3797:
#.##..####
.....#....
#...#...#.
#...##....
#....#..#.
#...##.##.
##...##.#.
#.......#.
#.##...#.#
#...##.#..

Tile 2089:
##..###..#
##...#..#.
#....##..#
..##.....#
.......#.#
#.....#..#
#....#....
.....#.##.
..##..#.##
.....##..#

Tile 3821:
.###.....#
..#.#..##.
.#...#....
.........#
#...#.....
#....##..#
#...#....#
#...#...#.
..#..#....
##.####...

Tile 2549:
...###.#..
..#.##..#.
#.#.......
..##......
#.#......#
..#...#..#
.#..#.##..
..#....#..
#...##..#.
##..#..#.#

Tile 1697:
.##.#.##..
.......#..
.#....####
#......#.#
.......#..
...#..#..#
#......#.#
.#.....###
#..#...#..
#...###...

Tile 2749:
..#...#..#
..#...#..#
#.##.###..
..##......
#..#.###..
#.####....
#.....#...
#.#.#.....
#.........
#...###.##

Tile 1063:
.##..#..#.
..#....#.#
..##..#..#
........#.
...#.....#
.........#
#.....#.##
.......###
##..#.#...
.#..####..

Tile 1471:
...##..#.#
##.#..#...
#...#....#
..#......#
#.#.#...##
..##.....#
.........#
......##.#
.#..#.#..#
#...#####.

Tile 1609:
#..##.####
##...#....
#.#...#...
.#.###.###
.....#.#..
##....#...
...##...#.
##........
#...#.#...
##...#....

Tile 2437:
..##.#.#.#
..#.#....#
...#......
#.....#..#
.#....#..#
##..##....
#.#......#
.....#..#.
....##.###
..#####.##

Tile 1823:
###..###..
##...#....
#.....###.
#........#
.....###.#
.....#..##
#..#..#...
##........
#.........
..########

Tile 2273:
#.#.#.#.##
....#..#..
#..#......
#....##...
.#.#..#.##
#.........
.#.##..#..
..#......#
#....##.#.
##.##.####

Tile 3607:
##.#.###.#
...#.....#
##..##..##
...###....
..##.#...#
#.#...#.#.
#...#....#
#..####...
....#.#.#.
...#...###

Tile 1303:
.#..######
...#...#.#
..##...##.
....#..#..
#.#.###.##
##.#..####
..#...#...
#.#.#..#.#
#.........
#.#.#####.

Tile 1283:
.#.#.#....
.#..##....
.#...#....
#.........
##.###...#
##.####..#
#....#...#
.#.#...#.#
#.##.....#
##.#..#.#.

Tile 2791:
#....###..
....#....#
#......#.#
#....#.##.
.#.##....#
#......#.#
.......#..
....#....#
#..#......
..#####.##

Tile 2797:
.#####..#.
.......#..
#..##....#
.##...##.#
.#...#.#.#
#.#...##.#
#.#.......
##.##...##
..#....#..
###..##...

Tile 1087:
......#.##
#.#......#
.#....#..#
#.#.#.#..#
#...#.....
#..#...#..
.....#...#
...#......
#.....#..#
###..##.##

Tile 1409:
#####.###.
.#.#.#...#
#....#...#
.....#.#.#
#....#..##
###..##.##
##..####..
..........
#........#
.####.#.##

Tile 3593:
#.######..
##...#.#..
..#......#
#.....##.#
.#...#....
#...#.#.#.
...#..#...
##.......#
.....#...#
...#..#..#

Tile 3347:
.#.##.#.#.
..........
....#...#.
#.#..#..##
...#..##..
##.#....#.
#.#..#...#
.#.###.#.#
#...#.#..#
.#.####.##

Tile 3637:
.#.##....#
##...###.#
.#.#.#....
....##...#
.#........
#......#..
##.#...#..
###..##..#
.#........
...#.###..

Tile 1907:
#.#.#..###
.##..#....
##..#..#.#
.......#..
#..#......
..##.#..#.
.###..##.#
.......#.#
.#....#...
#..#...#.#

Tile 3371:
#.##...###
.....#....
#......#..
.#.#..#...
##.#...#..
.##......#
..#..###.#
#.....#.#.
#.#..#.#.#
...#..####

Tile 1367:
##.....#..
.#..#..#..
.###....##
.#.#..#.##
##.....##.
###.....##
...#...#.#
#....#...#
##.....#.#
#....#.##.

Tile 1559:
#..#.##..#
#..#.##...
#.#..#...#
.......#.#
....#.####
#...#...##
..#.#...##
#....#...#
..#..#.#.#
.........#

Tile 2713:
..#.###.##
#.##.....#
#......#.#
#..#...#..
.#.......#
.......##.
.........#
..#...##.#
#....#.#.#
#.#..##...

Tile 3203:
###.#####.
###...#...
###..#...#
.#..##..##
#....#.##.
#.....#..#
#....#...#
..........
.##...#...
.#.###.##.

Tile 1979:
#...#.#..#
#.#.....#.
.#.###...#
.....#.##.
##.#.#..##
.##....###
.##......#
#......#.#
#.....#.#.
......##.#

Tile 3307:
..##...#.#
#......#..
##..#.##..
...##.#.##
.##.......
.##....###
#..##.#..#
.#.#.#....
#...#.#..#
#.#..###.#

Tile 1667:
###.#.##..
.......##.
..#...##..
........##
#.......##
#.....##..
...##.#.#.
#.......#.
........##
##....#...

Tile 1699:
..##...###
.....#....
#..#.###..
...##.....
.##.#..#..
......#...
#.........
####.....#
#.#..#....
#...#..#.#

Tile 2591:
#...##....
###..###..
##.#..#...
..#.#..##.
.....#.#.#
##..###...
#..####.##
##........
..#......#
.###.#..#.

Tile 3169:
####.##...
##.##.....
......#...
#.##..#.##
....###.#.
#.#..#..##
#..###....
#..#.....#
..###..#..
##..##..#.

Tile 1459:
..#...####
.....##...
..#.......
...#.#....
##....#..#
.##...##.#
..#..#.###
#.##..#...
#..#.#.#.#
..#.#.##..

Tile 3373:
..#####..#
..#..#...#
#.###..#.#
...##.....
.#.##.....
#..#..#...
....#.....
#.#.#....#
...#...#..
.##.......

Tile 3461:
######...#
....##....
##........
#.#..#.#.#
###.....#.
.....#....
.....###.#
##.......#
....###.#.
..#.#..##.

Tile 2609:
#####...##
#.........
.....##...
##....##..
..##.#....
##.......#
........#.
........##
####......
.#.###....

Tile 2459:
#..##.#...
.#...#####
##........
#....#....
#...##.#..
##...###.#
##........
...##....#
#...#....#
.##.....#.

Tile 1831:
###..#..##
.#......##
.#.#..#...
#......#.#
#.........
..#....#..
.####...#.
....#..#..
......##.#
###...#..#

Tile 2063:
.###...#.#
###......#
##..#..###
##........
.###.##.##
##.#.#..#.
..##....##
..#......#
#####...#.
#####..#..

Tile 2281:
#...####..
..#.#....#
........#.
#.........
..#..#..##
##.##..#.#
........#.
....##...#
####.#.#.#
.###..#..#

Tile 1583:
#####.##.#
#....##.#.
#..##.....
...#......
..###.#...
..##.....#
##..#....#
.....#...#
.......##.
#.##...#.#

Tile 2539:
..##......
.#..#..#..
#...#...#.
#..##.#.#.
......####
#.##...##.
##...#..#.
#.#......#
##....#..#
###..#...#

Tile 2909:
..#.....##
##...##..#
#........#
.#........
###....###
...#.##..#
#..#..##..
#..##...#.
....#....#
#..##..#..

Tile 2939:
..#...#.#.
..#.......
..........
.#.##..#.#
#.##.##.#.
###.#....#
..#..#....
.##......#
##...##...
##.#..#...

Tile 3889:
##..#.#.##
##.####...
#.#.####..
..####..#.
##.#.....#
#.......##
........##
##.##....#
...###...#
#..###..##

Tile 1427:
#.#.#....#
##.##.####
.....#...#
#.#..#....
...#.#..#.
.....#...#
.#...###.#
####.#....
........##
#..#..##..

Tile 1319:
.#####...#
#...#....#
#........#
#....##...
.##......#
..#.....##
.....#..##
......#..#
...#....#.
.##....###

Tile 1523:
.....###.#
..#......#
...#.....#
#..#..#..#
.........#
#..#..#.#.
####..#..#
..#......#
...##.##.#
####....##

Tile 2381:
.#.#..##.#
#..#..#.##
..........
..###..#..
.###.##.##
##....##.#
...##....#
#...#.....
.#.......#
#....###..";